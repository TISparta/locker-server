<div id="map"></div>

<script>
  var map;
  function initMap () {
    map = new google.maps.Map(document.getElementById('map'), {
    center: {lat: -12.134629, lng: -77.022203},
    zoom: 16
    })

  function addMarker (coords) {
    console.log(coords)
    var marker = new google.maps.Marker({
      position: {
        'lat': coords.lat,
        'lng': coords.lng
      },
      map: map,
      icon: {
        url: 'http://i.imgur.com/AYFjkdJ.png',
      }
    })
    let foo = '<a href="/bicycle/' + coords.code + '\">+Info</a>'
    var infoWindow = new google.maps.InfoWindow({
      content: String(foo)
    })
    marker.addListener('click', function () {
     infoWindow.open(map, marker)
    })
  }

  {{#each locations}}
    addMarker({code: "{{code}}", lat: parseFloat("{{lat}}"), lng: parseFloat("{{lng}}") })
  {{/each}}

}
</script>

<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCOpyNedLt7ouwBMhS_hdNFYuosqW_irCA&callback=initMap" async defer></script>
